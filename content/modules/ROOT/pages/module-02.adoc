:hybrid_cloud_url: https://console.redhat.com[window=_blank]
:hybrid_cloud_username: lab-EB9A
:hybrid_cloud_password: R3dh4t2024!
:imagesdir: ../assets/images

= Red Hat Insight


== Red Hat Hybrid Cloud Console

. To setup insight trigger log into the Red Hat Hybrid Cloud console.
+
****
[upperalpha]
.. Log in with the following details:
... URL: {hybrid_cloud_url}
... User:	{hybrid_cloud_username}
... Password: {hybrid_cloud_password}
+
NOTE: This user has limited permissions in the Hybrid Cloud Console, and while they can complete all of the activities in this lab exercise, there are certain capabilities that they will not have - this is expected and is done by design to provide a positive lab experience for all users.

****

. Get Event stream URL
+
****
[upperalpha]

.. Next we need to get the Event stream URL and copy it for use in setting up your integration with Insights.

... Go to Automation Decisions → Event Streams
... On the Details tab, locate the URL.  
... Click the copy button to copy the URL to the clipboard.

+
NOTE: With this URL copied to your clipboard we will log into the Red Hat Hybrid Cloud Console, in the following steps, to create an Event-driven Ansible integration which will send detected events from the console to Event-driven Ansible.  

+
image::eda-event-stream-url.jpg[Event Stream]

****


. Creating Hybrid Cloud Console Integrations
+
****
[upperalpha]
.. To create an integration with Event Driven Ansible after login into Red Hat Hybrid Cloud Console, follow the steps given below.

... Click the gear icon in the upper right hand corner, then click integrations.

+
image::hybrid-cloud-integration-gear.jpg[Integration Gear]

... Click the Reporting & Automation tab.

+
image::hybrid-cloud-integration-reporting-automation.jpg[Reporting and Automation]

... Click Add integration.

... Select Event-Driven Ansible and click Next

+
image::hybrid-cloud-integration-eda.jpg[Event-Driven Ansible]

... Enter integration details, as give below:
[loweralpha]
.... Name: {guid}-EDAIntegration
+
NOTE: Your RHEL host has a unique ID called a bastion ID.  Use this ID to uniquely identify your integration.  This is necessary since the Hybrid Cloud Console is a shared environment with other lab users.  
.... Endpoint URL: --<Paste Event Stream URL>--
+
NOTE: This is the event stream URL that you copied at the end of the last exercise.
.... Secret token: {hybrid_cloud_password}

... Click Next
... Review the settings and click Submit.

****

. Test the integration
+
****
[upperalpha]
.. To test, Locate the integration that you just created.
... Click the 3 vertical dots located at the end of the row.
... Click Test from the menu.
... To send a test from the Hybrid Cloud Console to the EDA instance, click Send.
+
NOTE: A message will appear in the upper right corner of the screen.  Click the hyperlink to be taken to the event log.
+
NOTE: the direct URL to the event log is: https://console.redhat.com/settings/notifications/eventlog 


... You should see an entry similar to this.
+
WARNING: If you receive an error message, double check your EDA URL and Token to make sure they were entered correctly.

****


. Configuring Hybrid Cloud Console Notifications 
+
****
[upperalpha]

[NOTE]
====
At this point you have a tested connection between your EDA instance and the Hybrid Cloud Console.
Now we need to tell the console what type of events we want to send to EDA.
This is done through notifications.
====

.. We are going to set up a notification to send Red Hat Enterprise Linux Malware Detection events onto EDA for processing with a rulebook.
 ... On the left hand navigation bar, click Notifications
 ... Then click Configure Events.

[NOTE] 
====
There are two sets of tabs here - the top tab shows platforms - Red Hat Enterprise Linux, Console (aka the Hybrid Cloud Console), and OpenShift. Make sure that Red Hat Enterprise Linux is selected.

The next set of tabs is Configuration and Behavior Groups.

Configuration shows you the different event types that are generated for Red Hat Enterprise Linux.
These are defined by the services - you cannot create new event types.

Behavior Groups allows you to group types of notifications together.  

====
.. You are going to create a new behavior group that sends Malware Detection events to your EDA integration that you created.

... Click Behavior Groups.
... Click Create new group

... In the wizard, complete the following:
.... Behavior Group Name: {guid}-BehaviorGroup
+
NOTE: Use the same bastion ID that you used above to uniquely identify your behavior group.
.... Click Next
.... Under Actions from the drop down box select Integration: Event-Driven Ansible
.... Under Recipient from the drop down box select your integration.
This should be: {guid}-EDAIntegration

+
NOTE: Additional actions can be added to a behavior group.  As an example, it is possible to have the same group sending data to EDA, Slack, ServiceNow, Microsoft Teams, and a generic webhook.
.... You'll just be configuring the EDA integration at this time.
Click Next.

.... Under Associate event types, in the “Filter by event type” box type malware.
... You.ll see the event type of “Detected Malware”. Check the box to the left of this event type.
.... Click Next.
.... Review and click Finish.

NOTE: At this point you have created an integration and a behavior group in the Hybrid Cloud Console.

****

